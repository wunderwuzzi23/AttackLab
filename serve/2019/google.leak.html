<html>
    <title>Google Unauthenticated Account Email Address Leakage</title>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css"> 
    <style>
        table { font-size: 14px; }
        table, th, td { border: 2px solid black;  border-collapse: collapse;}
        th, td { padding: 12px; text-align: left; }
        p { text-align: justify; }
        h2 {font-style: bold; }
    </style>
    <body>
        <br>
        <div class="w3-content" style="max-width:800px">
            <header class="w3-container w3-blue-grey ">
                <h1>Google Leaks Your Alternate Email Addresses to Unauthenticated Users</h1>
            </header>

            <p>The Google Login Flow leaks additional email account information to unauthenticated users. I discovered this in the Google Account Login flow while building KoiPhish.</p>
            <br>
            <b>Responsible Disclosure: </b>I reported this issue to Google and they looked into it and after a about 5 weeks of back and forth they decided that 
            this is not an issue worth fixing. After asking if I can post about it publicly I got Google's okay. So here we go! :)
            <p>
            <br>
            All that is needed to trigger the leakage is to call the unauthenticated signin endpoint at https://accounts.google.com/_signin/sl/lookup and in the f.req parameter provide an email address.
            <br><br>
            <img src="google.alternateaccount.leak.png"  width="80%"></img><br>
            <br><br>An adversary could do this at scale to retrieve additional accounts for phishing or possibly learn about recovery account - which in my case was the alternate account. lol. So, I'd assume others might have done the same.
            <br>
           
            <br>
            <b>Mitigations:</b> Remove all alternate account associations. Since the altnernate account might be your recovery address - it was setup for a couple of friends I shared this with, so it's likely a normal case.
            Make sure that any alternate account is not your password recovery or 2FA to minimize attack surface.
            <br><br>
            <footer class="w3-container w3-blue-grey"><p><br></p></footer>
            <br> 
            <br>Written February, 8th 2019. Posted June 2019. </p>
        </div>
    </body>
 </html>
