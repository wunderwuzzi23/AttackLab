<!DOCTYPE html>
<html lang="en-us">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
  <meta property="og:title" content=" Shadowbunny goes QEMU &middot;  Embrace The Red" />
  
  <meta property="og:site_name" content="Embrace The Red" />
  <meta property="og:url" content="https://embracethered.com/blog/posts/2021/qemu-shadowbunny-red-team/" />
  
  
  <meta property="og:type" content="article" />
  
  <meta property="og:article:published_time" content="2021-11-10T11:17:58-07:00" />
  
  <meta property="og:article:tag" content="pentest" />
  
  <meta property="og:article:tag" content="appsec" />
  
  <meta property="og:article:tag" content="webapp" />
  
  

  <title>
     Shadowbunny goes QEMU &middot;  Embrace The Red
  </title>

  <link rel="stylesheet" href="https://embracethered.com/blog/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://embracethered.com/blog/css/main.css" />
  <link rel="stylesheet" href="https://embracethered.com/blog/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://embracethered.com/blog/css/github.css" />
  
  <link rel="stylesheet" href="https://embracethered.com/blog/fonts/cachedfonts.css" type="text/css">
  <link rel="shortcut icon" href="https://embracethered.com/blog/images/favicon.ico" />
  <link rel="apple-touch-icon" href="https://embracethered.com/blog/images/apple-touch-icon.png" />
  

  
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@wunderwuzzi23">
<meta name="twitter:title" content="Shadowbunny goes QEMU">
<meta name="twitter:description" content="Using virtual machines to persist and evade detections">
<meta name="twitter:image" content="https://embracethered.com/blog/images/2020/shadowbunny-transparent.png">

<meta name="twitter:creator" content="@wunderwuzzi23">





</head>
<body>
    <header class="global-header"  style="background-image:url( /blog/images/bg.png )">
    <section class="header-text">
      <h1><a href="https://embracethered.com/blog/">Embrace The Red</a></h1>
      
      <div class="tag-line" style="min-width:fit-content; font-weight: 400;">
        wunderwuzzi&#39;s blog
        <br><a style="color: greenyellow; font-weight:300;text-decoration: underline; " href="https://www.amazon.com/gp/product/1838828869/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1838828869&linkCode=as2&tag=wunderwuzzi-20&linkId=b6523e937607be47499c6010ff489537">OUT NOW: Cybersecurity Attacks - Red Team Strategies</a> 
      </div>
      
      <div class="sns-links hidden-print">
  
  <a href="mailto:security@wunderwuzzi.net">
    <i class="fa fa-envelope"></i>
  </a>
  
  
  <a href="https://twitter.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-twitter"></i>
  </a>
  
  
  
  
  
  <a href="https://github.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  
  
  
  
  <a href="/blog/index.xml" target="_blank">
    <i class="fa fa-rss"></i>
  </a>
</div>

      
      <a href="https://embracethered.com/blog/" class="btn-header btn-back hidden-xs">
        <i class="fa fa-angle-left" aria-hidden="true"></i>
        &nbsp;Home
      </a>
      
    
      <a href="/blog/index.xml" class="btn-header btn-subscribe hidden-xs">
        <i class="fa fa-rss" aria-hidden="true"></i>
        &nbsp;Subscribe
      </a>
    </section>
  </header>
  <main class="container">


<article>
  <header>
    <h1 class="text-primary">Shadowbunny goes QEMU</h1>
    <div class="post-meta clearfix">
    
      <div class="post-date pull-left">
        Posted on
        <time datetime="2021-11-10T11:17:58-07:00">
          Nov 10, 2021
        </time>
      </div>
    
      <div class="pull-right">
        
        <span class="post-tag small"><a href="https://embracethered.com/blog//tags/pentest">#pentest</a></span>
        
        <span class="post-tag small"><a href="https://embracethered.com/blog//tags/appsec">#appsec</a></span>
        
        <span class="post-tag small"><a href="https://embracethered.com/blog//tags/webapp">#webapp</a></span>
        
      </div>
    </div>
  </header>
  <section>
    <p>For the last serveral years ransomware has become more and more prevelant, and modern day malware leverages virutalization technologies more commonly to do the dirty deats.</p>
<p>I wrote about how it is important that red teams perform operations to emulate such threats, or at least do some table-top excercises, and we also talked about detections strategies for virtualization based malware.</p>
<p>A good summary is my <a href="/blog/posts/2020/shadowbunny-virtual-machine-red-teaming-technique">Shadowbunny post</a> and <a href="https://www.youtube.com/watch?v=deGrbmTkRjQ">BSides Singapore talk</a>.</p>
<h2 id="what-is-qemu">What is QEMU?</h2>
<p>According to the QEMU wiki pages, it is &ldquo;a generic and open source machine emulator and virtualizer&rdquo;.</p>
<p>&ldquo;When used as a machine emulator, QEMU can run OSes and programs made for one machine (e.g. an ARM board) on a different machine (e.g. your own PC). By using dynamic translation, it achieves very good performance.&rdquo;</p>
<p>&ldquo;When used as a virtualizer, QEMU achieves near native performance by executing the guest code directly on the host CPU. QEMU supports virtualization when executing under the Xen hypervisor or using the KVM kernel module in Linux. When using KVM, QEMU can virtualize x86, server and embedded PowerPC, 64-bit POWER, S390, 32-bit and 64-bit ARM, and MIPS guests.&rdquo;</p>
<p>So this means that under Windows we won&rsquo;t be having the same isolation and performance as under Xen or KVM.</p>
<p>In this post I will focus on Windows</p>
<h2 id="installing">Installing</h2>
<p>Head over to <a href="https://qemu.weilnetz.de/">https://qemu.weilnetz.de/</a> to download the Windows port.</p>
<p><code>--accel whpx</code></p>
<p>&ldquo;If you want to have a fast x86 emulation running on Windows
without such restrictions, I suggest using VirtualBox instead
of QEMU.&rdquo;</p>
<h2 id="sharing-folders-and-making-host-accessible-to-guest">Sharing folders and making host accessible to guest</h2>
<p><a href="https://wiki.qemu.org/Documentation/9psetup">https://wiki.qemu.org/Documentation/9psetup</a></p>
<h2 id="detections">Detections</h2>
<h2 id="references">References</h2>
<ul>
<li><a href="https://wiki.qemu.org/Main_Page">QEMU Wiki</a></li>
<li><a href="https://qemu.weilnetz.de/">QEMU Windows Download</a></li>
<li><a href="/blog/posts/2020/shadowbunny-virtual-machine-red-teaming-technique">Shadowbunny post</a></li>
<li><a href="https://www.youtube.com/watch?v=deGrbmTkRjQ">BSides Singapore Shadowbunny talk</a></li>
<li></li>
</ul>

  </section>
  <footer>
    
    
    
    <footer></footer><hr/>
    
    <ul class="pager">
      
      <li class="next"><a href="https://embracethered.com/blog/posts/2021/offensive-bpf-red-team-simulate-ransomware/">Newer <span aria-hidden="true">&rarr;</span></a></li>
      
      
      <li class="author-contact">
        <a href="mailto:security@wunderwuzzi.net">
          <i class="fa fa-envelope-o" aria-hidden="true"></i>
          &nbsp;Contact me
        </a>
     </li>

      
      
      <li class="previous"><a href="https://embracethered.com/blog/posts/2021/video-anatomy-of-a-compromise/"><span aria-hidden="true">&larr;</span> Older</a></li>
      
    </ul>
  </footer>
</article>
</main>
  <footer class="container global-footer">
    <div class="copyright-note pull-left">
     
     (c) WUNDERWUZZI 2018-2021
     <div class="sns-links hidden-print">
  
  <a href="mailto:security@wunderwuzzi.net">
    <i class="fa fa-envelope"></i>
  </a>
  
  
  <a href="https://twitter.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-twitter"></i>
  </a>
  
  
  
  
  
  <a href="https://github.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  
  
  
  
  <a href="/blog/index.xml" target="_blank">
    <i class="fa fa-rss"></i>
  </a>
</div>
 
     <div style="font-size:small;font-style: italic;color:crimson">
    Disclaimer: Penetration testing requires authorization from proper stakeholders. Information on this blog is provided for research and educational purposes to advance understanding of attacks and countermeasures to help secure the Internet. 
    </div>
    </div>
</footer>
  <script src="https://embracethered.com/blog/js/highlight.pack.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>
  
  



<script type="text/javascript">
  var _paq = window._paq || [];
  _paq.push(["disableCookies"]);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//wuzzi.net/anamato/inc/";
    _paq.push(['setTrackerUrl', u+'rts.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'rts.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<img src="https://wuzzi.net/anamato/inc/rts.php?idsite=1&amp;rec=1" style="border:0;" alt="" />
  
</body>
</html>

